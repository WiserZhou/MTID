nohup: ignoring input
/home/zhouyufan/anaconda3/envs/ZYF/lib/python3.10/site-packages/torch/nn/modules/transformer.py:306: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
Namespace(checkpoint_root='/home/zhouyufan/Projects/PDPP/checkpoint', checkpoint_max_root='/home/zhouyufan/Projects/PDPP/save_max', log_root='/home/zhouyufan/Projects/PDPP/log/log', checkpoint_dir='whl', optimizer='adam', num_thread_reader=8, batch_size=256, batch_size_val=256, pretrain_cnn_path='', momemtum=0.9, save_freq=1, crop_only=1, centercrop=0, random_flip=1, verbose=1, fps=1, cudnn_benchmark=1, dataset='crosstask', action_dim=105, observation_dim=1536, class_dim=18, n_train_steps=200, root='/home/zhouyufan/Projects/PDPP/dataset/crosstask', json_path_train='/home/zhouyufan/Projects/PDPP/dataset/crosstask/crosstask_release/train_list.json', json_path_val='/home/zhouyufan/Projects/PDPP/dataset/crosstask/crosstask_release/test_list.json', json_path_val2='/home/zhouyufan/Projects/PDPP/dataset/crosstask/crosstask_release/output.json', start_epoch=0, resume=False, evaluate=True, pretrained=False, pin_memory=True, world_size=1, rank=0, dist_file='dist-file', dist_backend='nccl', gpu=6, multiprocessing_distributed=False, name='new_interpolation2', loss_type='Weighted_Gradient_MSE', ckpt_path='', dist_port=21712, horizon=3, epochs=70, log_freq=500, seed=217, weight=6, n_diffusion_steps=200, clip_denoised=True, ddim_discr_method='uniform', lr=0.0005, ema_decay=0.995, gradient_accumulate_every=1, step_start_ema=400, update_ema_every=10, debug=0, transformer_num=5)
Loaded /home/zhouyufan/Projects/PDPP/dataset/crosstask/crosstask_release/train_list.json
Loaded /home/zhouyufan/Projects/PDPP/dataset/crosstask/crosstask_release/output.json
logging outputs to  /home/zhouyufan/Projects/PDPP/log/log_new_interpolation2_20240726154019_crosstask

total train:   0%|          | 0/70 [00:00<?, ?it/s]lrs:
4.2857142857142856e-05
------------------------/PDPP/---
/home/zhouyufan/Projects/PDPP/utils/eval.py:88: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  torch.tensor(A0_acc.avg), torch.tensor(AT_acc.avg)

total train:   1%|▏         | 1/70 [03:42<4:16:19, 222.90s/it]1.6801221370697021 0
lrs:
8.571428571428571e-05
---------------------------------

total train:   3%|▎         | 2/70 [07:26<4:12:57, 223.20s/it]3.6220815181732178 1.6801221370697021
lrs:
0.00012857142857142855
---------------------------------

total train:   4%|▍         | 3/70 [11:10<4:10:00, 223.88s/it]4.014837265014648 3.6220815181732178
lrs:
0.00017142857142857143
---------------------------------

total train:   6%|▌         | 4/70 [14:55<4:06:43, 224.29s/it]4.145756244659424 4.014837265014648
lrs:
0.00021428571428571427
---------------------------------

total train:   7%|▋         | 5/70 [18:42<4:03:58, 225.20s/it]5.629500389099121 4.145756244659424
lrs:
0.0002571428571428571
---------------------------------

total train:   9%|▊         | 6/70 [22:33<4:02:07, 227.00s/it]6.982326030731201 5.629500389099121
lrs:
0.0003
---------------------------------

total train:  10%|█         | 7/70 [26:18<3:57:48, 226.48s/it]9.666157722473145 6.982326030731201
lrs:/PDPP/
0.00034285714285714285
---------------------------------

total train:  11%|█▏        | 8/70 [30:01<3:52:59, 225.47s/it]12.502727508544922 9.666157722473145
lrs:
0.00038571428571428567
---------------------------------

total train:  13%|█▎        | 9/70 [33:46<3:48:55, 225.17s/it]17.390356063842773 12.502727508544922
/home/zhouyufan/Projects/PDPP/utils/training.py:275: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  return torch.tensor(losses.avg), acc1, acc5, torch.tensor(trajectory_success_rate), \

total train:  14%|█▍        | 10/70 [37:44<3:49:05, 229.09s/it]20.466943740844727 17.390356063842773
lrs:
0.0004714285714285714
---------------------------------

total train:  16%|█▌        | 11/70 [41:34<3:45:28, 229.29s/it]23.325332641601562 20.466943740844727
lrs:
0.0005
---------------------------------

total train:  17%|█▋        | 12/70 [45:24<3:41:59, 229.64s/it]26.33646011352539 23.325332641601562
lrs:
0.0005
---------------------------------

total train:  19%|█▊        | 13/70 [49:14<3:38:23, 229.89s/it]28.409337997436523 26.33646011352539
lrs:
0.0005
---------------------------------

total train:  20%|██        | 14/70 [53:06<3:34:57, 230.30s/it]29.805803298950195 28.409337997436523
lrs:
0.0005
---------------------------------

total train:  21%|██▏       | 15/70 [56:55<3:30:52, 230.05s/it]31.4641056060791 29.805803298950195
lrs:
0.0005
---------------------------------

total train:  23%|██▎       | 16/70 [1:00:41<3:25:59, 228.87s/it]32.16233825683594 31.4641056060791
lrs:
0.0005
---------------------------------

total train:  24%|██▍       | 17/70 [1:04:35<3:23:21, 230.22s/it]33.427886962890625 32.16233825683594
lrs:
0.0005
---------------------------------

total train:  26%|██▌       | 18/70 [1:08:24<3:19:11, 229.84s/it]33.60244369506836 33.427886962890625
lrs:
0.0005
---------------------------------

total train:  27%|██▋       | 19/70 [1:12:12<3:14:53, 229.29s/it]34.47523498535156 33.60244369506836

total train:  29%|██▊       | 20/70 [1:16:12<3:13:56, 232.74s/it]35.348026275634766 34.47523498535156
lrs:
0.0005
---------------------------------

total train:  30%|███       | 21/70 [1:20:02<3:09:17, 231.78s/it]36.61357116699219 35.348026275634766
lrs:
0.0005
---------------------------------

total train:  31%|███▏      | 22/70 [1:23:51<3:04:47, 230.98s/it]36.61357116699219 36.61357116699219
lrs:
0.0005
---------------------------------

total train:  33%|███▎      | 23/70 [1:27:41<3:00:36, 230.55s/it]37.224525451660156 36.61357116699219
lrs:
0.0005
---------------------------------

total train:  34%|███▍      | 24/70 [1:31:32<2:56:52, 230.71s/it]37.48636245727539 37.224525451660156
lrs:
0.0005
---------------------------------

total train:  36%|███▌      | 25/70 [1:35:16<2:51:38, 228.86s/it]37.311805725097656 37.48636245727539
lrs:
0.0005
---------------------------------

total train:  37%|███▋      | 26/70 [1:39:03<2:47:25, 228.31s/it]38.359153747558594 37.48636245727539
lrs:
0.0005
---------------------------------

total train:  39%|███▊      | 27/70 [1:42:49<2:43:05, 227.58s/it]38.29369354248047 38.359153747558594
lrs:
0.0005
---------------------------------

total train:  40%|████      | 28/70 [1:46:39<2:39:41, 228.13s/it]38.402793884277344 38.359153747558594
lrs:
0.0005
---------------------------------

total train:  41%|████▏     | 29/70 [1:50:22<2:34:50, 226.60s/it]38.33733367919922 38.402793884277344

total train:  43%|████▎     | 30/70 [1:54:14<2:32:12, 228.32s/it]38.315513610839844 38.402793884277344
lrs:
0.00025
---------------------------------

total train:  44%|████▍     | 31/70 [1:58:06<2:29:12, 229.56s/it]38.75190734863281 38.402793884277344
lrs:
0.00025
---------------------------------

total train:  46%|████▌     | 32/70 [2:01:49<2:24:02, 227.42s/it]38.271873474121094 38.75190734863281
lrs:
0.00025
---------------------------------

total train:  47%|████▋     | 33/70 [2:05:32<2:19:29, 226.20s/it]38.62099075317383 38.75190734863281
lrs:
0.00025
---------------------------------

total train:  49%|████▊     | 34/70 [2:09:24<2:16:46, 227.96s/it]39.07920455932617 38.75190734863281
lrs:
0.00025
---------------------------------

total train:  50%|█████     | 35/70 [2:13:12<2:12:56, 227.90s/it]39.01374816894531 39.07920455932617
lrs:
0.00025
---------------------------------

total train:  51%|█████▏    | 36/70 [2:16:50<2:07:32, 225.07s/it]38.49007034301758 39.07920455932617
lrs:
0.00025
---------------------------------

total train:  53%|█████▎    | 37/70 [2:20:40<2:04:27, 226.29s/it]39.25376510620117 39.07920455932617
lrs:
0.00025
---------------------------------

total train:  54%|█████▍    | 38/70 [2:24:27<2:00:49, 226.56s/it]39.25376510620117 39.25376510620117
lrs:
0.00025
---------------------------------

total train:  56%|█████▌    | 39/70 [2:28:10<1:56:29, 225.45s/it]38.94828796386719 39.25376510620117

total train:  57%|█████▋    | 40/70 [2:32:05<1:54:11, 228.37s/it]38.70827102661133 39.25376510620117
lrs:
0.00025
---------------------------------

total train:  59%|█████▊    | 41/70 [2:35:48<1:49:39, 226.89s/it]38.86100769042969 39.25376510620117
lrs:
0.00025
---------------------------------

total train:  60%|██████    | 42/70 [2:39:33<1:45:36, 226.31s/it]38.97010803222656 39.25376510620117
lrs:
0.00025
---------------------------------

total train:  61%|██████▏   | 43/70 [2:43:14<1:41:03, 224.57s/it]38.75191116333008 39.25376510620117
lrs:
0.00025
---------------------------------

total train:  63%|██████▎   | 44/70 [2:46:58<1:37:17, 224.54s/it]38.88282775878906 39.25376510620117
lrs:
0.00025
---------------------------------

total train:  64%|██████▍   | 45/70 [2:50:43<1:33:37, 224.68s/it]38.162776947021484 39.25376510620117
lrs:
0.00025
---------------------------------

total train:  66%|██████▌   | 46/70 [2:54:30<1:30:05, 225.22s/it]38.315513610839844 39.25376510620117
lrs:
0.000125
---------------------------------

total train:  67%|██████▋   | 47/70 [2:58:16<1:26:26, 225.48s/it]38.09731674194336 39.25376510620117
lrs:
0.000125
---------------------------------

total train:  69%|██████▊   | 48/70 [3:01:57<1:22:13, 224.24s/it]38.14095687866211 39.25376510620117
lrs:
0.000125
---------------------------------

total train:  70%|███████   | 49/70 [3:05:41<1:18:28, 224.23s/it]38.162776947021484 39.25376510620117

total train:  71%|███████▏  | 50/70 [3:09:38<1:15:59, 227.97s/it]38.031856536865234 39.25376510620117
lrs:
0.000125
---------------------------------

total train:  73%|███████▎  | 51/70 [3:13:25<1:12:03, 227.55s/it]37.660919189453125 39.25376510620117
lrs:
0.000125
---------------------------------

total train:  74%|███████▍  | 52/70 [3:17:12<1:08:14, 227.49s/it]37.508182525634766 39.25376510620117
lrs:
0.000125
---------------------------------

total train:  76%|███████▌  | 53/70 [3:21:01<1:04:33, 227.84s/it]37.33362579345703 39.25376510620117
lrs:
0.000125
---------------------------------

total train:  77%|███████▋  | 54/70 [3:24:49<1:00:49, 228.11s/it]37.53000259399414 39.25376510620117
lrs:
0.000125
---------------------------------

total train:  79%|███████▊  | 55/70 [3:28:33<56/PDPP/26.71s/it]  37.377262115478516 39.25376510620117/PDPP//PDPP//PDPP//PDPP//PDPP//PDPP//PDPP/
lrs:/PDPP/
0.000125
---------------------------------

total train:  80%|████████  | 56/70 [3:32:14<52:32, 225.19s/it]37.420902252197266 39.25376510620117
lrs:
0.000125
---------------------------------

total train:  81%|████████▏ | 57/70 [3:36:02<48:58, 226.03s/it]37.268165588378906 39.25376510620117
lrs:
0.000125
---------------------------------

total train:  83%|████████▎ | 58/70 [3:39:50<45:17, 226.46s/it]37.02814865112305 39.25376510620117
lrs:
0.000125
---------------------------------

total train:  84%|████████▍ | 59/70 [3:43:35<41:27, 226.18s/it]36.9845085144043 39.25376510620117

total train:  86%|████████▌ | 60/70 [3:47:34<38:17, 229.79s/it]37.093605041503906 39.25376510620117
lrs:
0.000125
---------------------------------

total train:  87%|████████▋ | 61/70 [3:51:19<34:17, 228.60s/it]37.15906524658203 39.25376510620117
lrs:
0.000125
---------------------------------

total train:  89%|████████▊ | 62/70 [3:55:10<30:34, 229.25s/it]36.83176803588867 39.25376510620117
lrs:
0.000125
---------------------------------

total train:  90%|█████████ | 63/70 [3:59:00<26:46, 229.46s/it]36.8099479675293 39.25376510620117
lrs:
0.000125
---------------------------------

total train:  91%|█████████▏| 64/70 [4:02:52<23:00, 230.03s/it]36.70085144042969 39.25376510620117
lrs:
6.25e-05
---------------------------------

total train:  93%|█████████▎| 65/70 [4:06:39<19:06, 229.21s/it]36.72267150878906 39.25376510620117
lrs:
6.25e-05
---------------------------------

total train:  94%|█████████▍| 66/70 [4:10:26<15:14, 228.59s/it]36.63539123535156 39.25376510620117
lrs:
6.25e-05
---------------------------------

total train:  96%|█████████▌| 67/70 [4:14:15<11:25, 228.65s/it]36.65721130371094 39.25376510620117
lrs:
6.25e-05
---------------------------------

total train:  97%|█████████▋| 68/70 [4:18:01<07:36, 228.07s/it]36.76631164550781 39.25376510620117
lrs:
6.25e-05
---------------------------------

total train:  99%|█████████▊| 69/70 [4:21:50<03:48, 228.18s/it]36.70085144042969 39.25376510620117

total train: 100%|██████████| 70/70 [4:25:42<00:00, 229.35s/it]
total train: 100%|██████████| 70/70 [4:25:42<00:00, 227.75s/it]
37.02814865112305 39.25376510620117
=> loading checkpoint '/home/zhouyufan/Projects/PDPP/save_max/epoch_new_interpolation2_0038_0.pth.tar' Namespace(checkpoint_root='/home/zhouyufan/Projects/PDPP/checkpoint', checkpoint_max_root='/home/zhouyufan/Projects/PDPP/save_max', log_root='/home/zhouyufan/Projects/PDPP/log/log', checkpoint_dir='whl', optimizer='adam', num_thread_reader=8, batch_size=256, batch_size_val=256, pretrain_cnn_path='', momemtum=0.9, save_freq=1, crop_only=1, centercrop=0, random_flip=1, verbose=1, fps=1, cudnn_benchmark=1, dataset='crosstask', action_dim=105, observation_dim=1536, class_dim=18, n_train_steps=200, root='/home/zhouyufan/Projects/PDPP/dataset/crosstask', json_path_train='/home/zhouyufan/Projects/PDPP/dataset/crosstask/crosstask_release/train_list.json', json_path_val='/home/zhouyufan/Projects/PDPP/dataset/crosstask/crosstask_release/test_list.json', json_path_val2='/home/zhouyufan/Projects/PDPP/dataset/crosstask/crosstask_release/output.json', start_epoch=0, resume=False, evaluate=True, pretrained=False, pin_memory=True, world_size=1, rank=0, dist_file='dist-file', dist_backend='nccl', gpu=6, multiprocessing_distributed=False, name='new_interpolation2', loss_type='Weighted_Gradient_MSE', ckpt_path='', dist_port=21712, horizon=3, epochs=70, log_freq=500, seed=217, weight=6, n_diffusion_steps=200, clip_denoised=True, ddim_discr_method='uniform', lr=0.0005, ema_decay=0.995, gradient_accumulate_every=1, step_start_ema=400, update_ema_every=10, debug=0, transformer_num=5, distributed=False)
/home/zhouyufan/Projects/PDPP/inference.py:133: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  torch.tensor(A0_acc.avg), torch.tensor(AT_acc.avg)
time:  8.36668062210083
-----------------Mean&Var-----------------------
Val/EpochAcc@1 65.91024780273438
Val/Traj_Success_Rate 38.88282775878906
Val/MIoU1 58.70135498046875 0.0
Val/MIoU2 67.73983764648438
Val/acc_a0 73.4671630859375 0.0
Val/acc_aT 72.55072784423828 0.0
new_interpolation2 crosstask 3 38 38.88282775878906 65.91024780273438 67.73983764648438
