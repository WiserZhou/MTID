nohup: ignoring input
Namespace(checkpoint_root='/home/zhouyufan/Projects/PDPP/checkpoint', checkpoint_max_root='/home/zhouyufan/Projects/PDPP/save_max', log_root='/home/zhouyufan/Projects/PDPP/log/log', checkpoint_dir='whl', optimizer='adam', num_thread_reader=8, batch_size=256, batch_size_val=256, pretrain_cnn_path='', momemtum=0.9, log_freq=500, save_freq=1, gradient_accumulate_every=1, ema_decay=0.995, step_start_ema=400, update_ema_every=10, crop_only=1, centercrop=0, random_flip=1, verbose=1, fps=1, cudnn_benchmark=1, dataset='crosstask', action_dim=105, observation_dim=1536, class_dim=18, n_diffusion_steps=200, n_train_steps=200, root='/home/zhouyufan/Projects/PDPP/dataset/crosstask', json_path_train='/home/zhouyufan/Projects/PDPP/dataset/crosstask/crosstask_release/train_list.json', json_path_val='/home/zhouyufan/Projects/PDPP/dataset/crosstask/crosstask_release/test_list.json', json_path_val2='/home/zhouyufan/Projects/PDPP/dataset/crosstask/crosstask_release/output.json', start_epoch=0, lr=0.0005, resume=False, evaluate=True, pretrained=False, pin_memory=True, world_size=1, rank=0, dist_file='dist-file', dist_backend='nccl', seed=217, gpu=0, multiprocessing_distributed=False, name='4layer2', loss_kind='Weighted_Gradient_MSE', ckpt_path='', layer_num=4, dist_port=21712, horizon=3, weight=6, epochs=120)
Loaded /home/zhouyufan/Projects/PDPP/dataset/crosstask/crosstask_release/train_list.json
Loaded /home/zhouyufan/Projects/PDPP/dataset/crosstask/crosstask_release/output.json
logging outputs to  /home/zhouyufan/Projects/PDPP/log/log_4layer2_20240719224614_crosstask
total train:   0%|          | 0/120 [00:00<?, ?it/s]lrs:
2.5e-05
---------------------------------
/home/zhouyufan/Projects/PDPP/utils/eval.py:88: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  torch.tensor(A0_acc.avg), torch.tensor(AT_acc.avg)
total train:   1%|          | 1/120 [00:30<1:01:08, 30.83s/it]4.494872570037842 0
lrs:
5e-05
---------------------------------
total train:   2%|▏         | 2/120 [01:00<59:42, 30.36s/it]  1.35282564163208 4.494872570037842
lrs:
7.5e-05
---------------------------------
total train:   2%|▎         | 3/120 [01:30<58:46, 30.14s/it]1.3310059309005737 4.494872570037842
lrs:
0.0001
---------------------------------
total train:   3%|▎         | 4/120 [01:57<55:46, 28.85s/it]1.3310059309005737 4.494872570037842
lrs:
0.000125
---------------------------------
total train:   4%|▍         | 5/120 [02:28<56:49, 29.65s/it]1.4837442636489868 4.494872570037842
lrs:
0.00015
---------------------------------
total train:   5%|▌         | 6/120 [02:55<54:25, 28.64s/it]1.6364825963974 4.494872570037842
lrs:
0.000175
---------------------------------
total train:   6%|▌         | 7/120 [03:24<54:04, 28.72s/it]1.6801221370697021 4.494872570037842
lrs:
0.0002
---------------------------------
total train:   7%|▋         | 8/120 [03:54<54:34, 29.24s/it]1.6801221370697021 4.494872570037842
lrs:
0.00022500000000000002
---------------------------------
total train:   8%|▊         | 9/120 [04:24<54:41, 29.57s/it]1.8328605890274048 4.494872570037842
/home/zhouyufan/Projects/PDPP/utils/training.py:162: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  return torch.tensor(losses.avg), acc1, acc5, torch.tensor(trajectory_success_rate), \
total train:   8%|▊         | 10/120 [04:58<56:22, 30.75s/it]2.378354787826538 4.494872570037842
lrs:
0.000275
---------------------------------
total train:   9%|▉         | 11/120 [05:29<56:21, 31.02s/it]6.5459303855896 4.494872570037842
lrs:
0.0003
---------------------------------
total train:  10%|█         | 12/120 [05:56<53:19, 29.63s/it]11.149901390075684 6.5459303855896
lrs:
0.00032500000000000004
---------------------------------
total train:  11%|█         | 13/120 [06:27<53:26, 29.97s/it]15.710233688354492 11.149901390075684
lrs:
0.00035
---------------------------------
total train:  12%|█▏        | 14/120 [06:58<53:40, 30.38s/it]19.812349319458008 15.710233688354492
lrs:
0.000375
---------------------------------
total train:  12%|█▎        | 15/120 [07:30<53:57, 30.83s/it]23.21623420715332 19.812349319458008
lrs:
0.0004
---------------------------------
total train:  13%|█▎        | 16/120 [08:00<53:04, 30.62s/it]25.98734474182129 23.21623420715332
lrs:
0.000425
---------------------------------
total train:  14%|█▍        | 17/120 [08:31<52:57, 30.85s/it]28.016582489013672 25.98734474182129
lrs:
0.00045000000000000004
---------------------------------
total train:  15%|█▌        | 18/120 [09:03<52:45, 31.04s/it]29.522146224975586 28.016582489013672
lrs:
0.000475
---------------------------------
total train:  16%|█▌        | 19/120 [09:35<52:53, 31.42s/it]30.72223472595215 29.522146224975586
total train:  17%|█▋        | 20/120 [10:09<53:43, 32.23s/it]31.50774574279785 30.72223472595215
lrs:
0.0005
---------------------------------
total train:  18%|█▊        | 21/120 [10:40<52:32, 31.84s/it]32.926029205322266 31.50774574279785
lrs:
0.0005
---------------------------------
total train:  18%|█▊        | 22/120 [11:12<51:56, 31.81s/it]33.60244369506836 32.926029205322266
lrs:
0.0005
---------------------------------
total train:  19%|█▉        | 23/120 [11:45<52:13, 32.31s/it]34.67161178588867 33.60244369506836
lrs:
0.0005
---------------------------------
total train:  20%|██        | 24/120 [12:18<51:47, 32.37s/it]35.217105865478516 34.67161178588867
lrs:
0.0005
---------------------------------
total train:  21%|██        | 25/120 [12:49<50:53, 32.14s/it]35.93716049194336 35.217105865478516
lrs:
0.0005
---------------------------------
total train:  22%|██▏       | 26/120 [13:21<50:16, 32.09s/it]36.59175109863281 35.93716049194336
lrs:
0.0005
---------------------------------
total train:  22%|██▎       | 27/120 [13:52<49:10, 31.72s/it]36.87540817260742 36.59175109863281
lrs:
0.0005
---------------------------------
total train:  23%|██▎       | 28/120 [14:24<48:35, 31.69s/it]37.464542388916016 36.87540817260742
lrs:
0.0005
---------------------------------
total train:  24%|██▍       | 29/120 [14:53<46:55, 30.94s/it]37.72637939453125 37.464542388916016
total train:  25%|██▌       | 30/120 [15:23<45:46, 30.51s/it]37.61728286743164 37.72637939453125
lrs:
0.0005
---------------------------------
total train:  26%|██▌       | 31/120 [15:53<45:16, 30.52s/it]37.81365966796875 37.72637939453125
lrs:
0.0005
---------------------------------
total train:  27%|██▋       | 32/120 [16:24<45:03, 30.73s/it]37.879119873046875 37.81365966796875
lrs:
0.0005
---------------------------------
total train:  28%|██▊       | 33/120 [16:56<44:50, 30.93s/it]38.01003646850586 37.879119873046875
lrs:
0.0005
---------------------------------
total train:  28%|██▊       | 34/120 [17:27<44:21, 30.95s/it]38.031856536865234 38.01003646850586
lrs:
0.0005
---------------------------------
total train:  29%|██▉       | 35/120 [17:57<43:21, 30.61s/it]38.271873474121094 38.031856536865234
lrs:
0.0005
---------------------------------
total train:  30%|███       | 36/120 [18:27<42:49, 30.59s/it]38.42461395263672 38.271873474121094
lrs:
0.0005
---------------------------------
total train:  31%|███       | 37/120 [18:59<42:59, 31.07s/it]38.402793884277344 38.42461395263672
lrs:
0.0005
---------------------------------
total train:  32%|███▏      | 38/120 [19:31<42:35, 31.17s/it]38.57735061645508 38.42461395263672
lrs:
0.0005
---------------------------------
total train:  32%|███▎      | 39/120 [19:59<40:57, 30.33s/it]38.38097381591797 38.57735061645508
total train:  33%|███▎      | 40/120 [20:31<41:11, 30.89s/it]38.53371047973633 38.57735061645508
lrs:
0.0005
---------------------------------
total train:  34%|███▍      | 41/120 [21:01<40:07, 30.47s/it]38.66463088989258 38.57735061645508
lrs:
0.0005
---------------------------------
total train:  35%|███▌      | 42/120 [21:30<39:10, 30.13s/it]38.402793884277344 38.66463088989258
lrs:
0.0005
---------------------------------
total train:  36%|███▌      | 43/120 [21:57<37:16, 29.04s/it]38.359153747558594 38.66463088989258
lrs:
0.0005
---------------------------------
total train:  37%|███▋      | 44/120 [22:28<37:32, 29.63s/it]38.271873474121094 38.66463088989258
lrs:
0.0005
---------------------------------
total train:  38%|███▊      | 45/120 [22:59<37:34, 30.06s/it]38.25005340576172 38.66463088989258
lrs:
0.0005
---------------------------------
total train:  38%|███▊      | 46/120 [23:25<35:44, 28.98s/it]38.446434020996094 38.66463088989258
lrs:
0.0005
---------------------------------
total train:  39%|███▉      | 47/120 [23:55<35:27, 29.14s/it]38.5555305480957 38.66463088989258
lrs:
0.0005
---------------------------------
total train:  40%|████      | 48/120 [24:25<35:33, 29.63s/it]38.51189041137695 38.66463088989258
lrs:
0.0005
---------------------------------
total train:  41%|████      | 49/120 [24:56<35:22, 29.89s/it]38.402793884277344 38.66463088989258
total train:  42%|████▏     | 50/120 [25:27<35:06, 30.09s/it]38.446434020996094 38.66463088989258
lrs:
0.00025
---------------------------------
total train:  42%|████▎     | 51/120 [25:55<34:04, 29.63s/it]38.01003646850586 38.66463088989258
lrs:
0.00025
---------------------------------
total train:  43%|████▎     | 52/120 [26:23<33:09, 29.25s/it]37.704559326171875 38.66463088989258
lrs:
0.00025
---------------------------------
total train:  44%|████▍     | 53/120 [26:54<33:10, 29.71s/it]37.61728286743164 38.66463088989258
lrs:
0.00025
---------------------------------
total train:  45%|████▌     | 54/120 [27:29<34:17, 31.18s/it]37.44272232055664 38.66463088989258
lrs:
0.00025
---------------------------------
total train:  46%|████▌     | 55/120 [27:56<32:21, 29.86s/it]37.44272232055664 38.66463088989258
lrs:
0.00025
---------------------------------
total train:  47%|████▋     | 56/120 [28:29<32:53, 30.84s/it]37.508182525634766 38.66463088989258
lrs:
0.00025
---------------------------------
total train:  48%|████▊     | 57/120 [28:59<32:03, 30.53s/it]37.311805725097656 38.66463088989258
lrs:
0.00025
---------------------------------
total train:  48%|████▊     | 58/120 [29:28<31:19, 30.32s/it]37.377262115478516 38.66463088989258
lrs:
0.00025
---------------------------------
total train:  49%|████▉     | 59/120 [29:59<31:01, 30.52s/it]37.20270538330078 38.66463088989258
total train:  50%|█████     | 60/120 [30:31<30:46, 30.78s/it]37.33362579345703 38.66463088989258
lrs:
0.00025
---------------------------------
total train:  51%|█████     | 61/120 [31:03<30:39, 31.18s/it]37.20270538330078 38.66463088989258
lrs:
0.00025
---------------------------------
total train:  52%|█████▏    | 62/120 [31:33<29:42, 30.74s/it]37.39908218383789 38.66463088989258
lrs:
0.00025
---------------------------------
total train:  52%|█████▎    | 63/120 [32:02<28:45, 30.28s/it]37.180885314941406 38.66463088989258
lrs:
0.00025
---------------------------------
total train:  53%|█████▎    | 64/120 [32:32<28:13, 30.24s/it]37.24634552001953 38.66463088989258
lrs:
0.00025
---------------------------------
total train:  54%|█████▍    | 65/120 [33:01<27:29, 29.99s/it]37.268165588378906 38.66463088989258
lrs:
0.00025
---------------------------------
total train:  55%|█████▌    | 66/120 [33:30<26:43, 29.70s/it]37.224525451660156 38.66463088989258
lrs:
0.00025
---------------------------------
total train:  56%|█████▌    | 67/120 [34:00<26:18, 29.78s/it]37.00632858276367 38.66463088989258
lrs:
0.00025
---------------------------------
total train:  57%|█████▋    | 68/120 [34:29<25:36, 29.54s/it]37.11542510986328 38.66463088989258
lrs:
0.00025
---------------------------------
total train:  57%|█████▊    | 69/120 [34:59<25:14, 29.70s/it]37.24634552001953 38.66463088989258
total train:  58%|█████▊    | 70/120 [35:28<24:35, 29.51s/it]37.137245178222656 38.66463088989258
lrs:
0.00025
---------------------------------
total train:  59%|█████▉    | 71/120 [35:59<24:20, 29.80s/it]37.02814865112305 38.66463088989258
lrs:
0.00025
---------------------------------
total train:  60%|██████    | 72/120 [36:28<23:44, 29.67s/it]36.8099479675293 38.66463088989258
lrs:
0.00025
---------------------------------
total train:  61%|██████    | 73/120 [36:57<23:03, 29.44s/it]36.78813171386719 38.66463088989258
lrs:
0.00025
---------------------------------
total train:  62%|██████▏   | 74/120 [37:27<22:35, 29.46s/it]36.4826545715332 38.66463088989258
lrs:
0.00025
---------------------------------
total train:  62%|██████▎   | 75/120 [37:56<22:00, 29.34s/it]36.63539123535156 38.66463088989258
lrs:
0.00025
---------------------------------
total train:  63%|██████▎   | 76/120 [38:25<21:31, 29.35s/it]36.74449157714844 38.66463088989258
lrs:
0.00025
---------------------------------
total train:  64%|██████▍   | 77/120 [38:53<20:48, 29.04s/it]36.52629089355469 38.66463088989258
lrs:
0.00025
---------------------------------
total train:  65%|██████▌   | 78/120 [39:23<20:20, 29.07s/it]36.54811096191406 38.66463088989258
lrs:
0.00025
---------------------------------
total train:  66%|██████▌   | 79/120 [39:53<20:14, 29.61s/it]36.3080940246582 38.66463088989258
total train:  67%|██████▋   | 80/120 [40:28<20:40, 31.01s/it]36.43901443481445 38.66463088989258
lrs:
0.000125
---------------------------------
total train:  68%|██████▊   | 81/120 [41:05<21:20, 32.84s/it]36.43901443481445 38.66463088989258
lrs:
0.000125
---------------------------------
total train:  68%|██████▊   | 82/120 [41:45<22:07, 34.93s/it]36.35173416137695 38.66463088989258
lrs:
0.000125
---------------------------------
total train:  69%|██████▉   | 83/120 [42:25<22:35, 36.63s/it]36.35173416137695 38.66463088989258
lrs:
0.000125
---------------------------------
total train:  70%|███████   | 84/120 [43:06<22:42, 37.83s/it]36.28627395629883 38.66463088989258
lrs:
0.000125
---------------------------------
total train:  71%|███████   | 85/120 [43:46<22:32, 38.64s/it]36.242637634277344 38.66463088989258
lrs:
0.000125
---------------------------------
total train:  72%|███████▏  | 86/120 [44:27<22:14, 39.25s/it]36.28627395629883 38.66463088989258
lrs:
0.000125
---------------------------------
total train:  72%|███████▎  | 87/120 [45:08<21:51, 39.75s/it]36.28627395629883 38.66463088989258
lrs:
0.000125
---------------------------------
total train:  73%|███████▎  | 88/120 [45:48<21:10, 39.71s/it]36.3953742980957 38.66463088989258
lrs:
0.000125
---------------------------------
total train:  74%|███████▍  | 89/120 [46:28<20:41, 40.05s/it]36.37355422973633 38.66463088989258
total train:  75%|███████▌  | 90/120 [47:12<20:31, 41.05s/it]36.242637634277344 38.66463088989258
lrs:
0.000125
---------------------------------
total train:  76%|███████▌  | 91/120 [47:53<19:53, 41.14s/it]36.3080940246582 38.66463088989258
lrs:
0.000125
---------------------------------
total train:  77%|███████▋  | 92/120 [48:34<19:11, 41.13s/it]36.37355422973633 38.66463088989258
lrs:
0.000125
---------------------------------
total train:  78%|███████▊  | 93/120 [49:14<18:19, 40.71s/it]36.111717224121094 38.66463088989258
lrs:
0.000125
---------------------------------
total train:  78%|███████▊  | 94/120 [49:55<17:38, 40.73s/it]36.08989715576172 38.66463088989258
lrs:
0.000125
---------------------------------
total train:  79%|███████▉  | 95/120 [50:36<17:01, 40.85s/it]36.08989715576172 38.66463088989258
lrs:
0.000125
---------------------------------
total train:  80%|████████  | 96/120 [51:15<16:06, 40.26s/it]36.04625701904297 38.66463088989258
lrs:
0.000125
---------------------------------
total train:  81%|████████  | 97/120 [51:55<15:26, 40.29s/it]36.00261688232422 38.66463088989258
lrs:
0.000125
---------------------------------
total train:  82%|████████▏ | 98/120 [52:35<14:43, 40.18s/it]36.32991409301758 38.66463088989258
lrs:
0.000125
---------------------------------
total train:  82%|████████▎ | 99/120 [53:16<14:07, 40.35s/it]36.155357360839844 38.66463088989258
total train:  83%|████████▎ | 100/120 [53:57<13:32, 40.62s/it]36.22081756591797 38.66463088989258
lrs:
0.000125
---------------------------------
total train:  84%|████████▍ | 101/120 [54:37<12:49, 40.50s/it]36.3080940246582 38.66463088989258
lrs:
0.000125
---------------------------------
total train:  85%|████████▌ | 102/120 [55:18<12:10, 40.59s/it]36.32991409301758 38.66463088989258
lrs:
0.000125
---------------------------------
total train:  86%|████████▌ | 103/120 [55:59<11:29, 40.54s/it]36.198997497558594 38.66463088989258
lrs:
0.000125
---------------------------------
total train:  87%|████████▋ | 104/120 [56:40<10:50, 40.68s/it]35.980796813964844 38.66463088989258
lrs:
0.000125
---------------------------------
total train:  88%|████████▊ | 105/120 [57:19<10:06, 40.40s/it]36.068077087402344 38.66463088989258
lrs:
0.000125
---------------------------------
total train:  88%|████████▊ | 106/120 [57:59<09:23, 40.28s/it]36.22081756591797 38.66463088989258
lrs:
0.000125
---------------------------------
total train:  89%|████████▉ | 107/120 [58:40<08:45, 40.41s/it]36.04625701904297 38.66463088989258
lrs:
0.000125
---------------------------------
total train:  90%|█████████ | 108/120 [59:21<08:07, 40.65s/it]35.93716049194336 38.66463088989258
lrs:
0.000125
---------------------------------
total train:  91%|█████████ | 109/120 [1:00:02<07:26, 40.62s/it]35.958980560302734 38.66463088989258
