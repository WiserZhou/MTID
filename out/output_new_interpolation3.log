nohup: ignoring input
/home/zhouyufan/anaconda3/envs/ZYF/lib/python3.10/site-packages/torch/nn/modules/transformer.py:306: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
Namespace(checkpoint_root='/home/zhouyufan/Projects/PDPP/checkpoint', checkpoint_max_root='/home/zhouyufan/Projects/PDPP/save_max', log_root='/home/zhouyufan/Projects/PDPP/log/log', checkpoint_dir='whl', optimizer='adam', num_thread_reader=8, batch_size=256, batch_size_val=256, pretrain_cnn_path='', momemtum=0.9, save_freq=1, crop_only=1, centercrop=0, random_flip=1, verbose=1, fps=1, cudnn_benchmark=1, dataset='crosstask', action_dim=105, observation_dim=1536, class_dim=18, n_train_steps=200, root='/home/zhouyufan/Projects/PDPP/dataset/crosstask', json_path_train='/home/zhouyufan/Projects/PDPP/dataset/crosstask/crosstask_release/train_list.json', json_path_val='/home/zhouyufan/Projects/PDPP/dataset/crosstask/crosstask_release/test_list.json', json_path_val2='/home/zhouyufan/Projects/PDPP/dataset/crosstask/crosstask_release/output.json', start_epoch=0, resume=False, evaluate=True, pretrained=False, pin_memory=True, world_size=1, rank=0, dist_file='dist-file', dist_backend='nccl', gpu=3, multiprocessing_distributed=False, name='new_interpolation3', loss_type='Weighted_Gradient_MSE', ckpt_path='', dist_port=21712, horizon=3, epochs=70, log_freq=500, seed=217, weight=6, n_diffusion_steps=200, clip_denoised=True, ddim_discr_method='uniform', lr=0.0005, ema_decay=0.995, gradient_accumulate_every=1, step_start_ema=400, update_ema_every=10, imageEncoder=0, transformer_num=5, base_model='predictor')
Loaded /home/zhouyufan/Projects/PDPP/dataset/crosstask/crosstask_release/train_list.json
Loaded /home/zhouyufan/Projects/PDPP/dataset/crosstask/crosstask_release/output.json
logging outputs to  /home/zhouyufan/Projects/PDPP/log/log_new_interpolation3_20240729095020_crosstask
total train:   0%|          | 0/70 [00:00<?, ?it/s]lrs:
4.2857142857142856e-05
---------------------------------
/home/zhouyufan/Projects/PDPP/utils/eval.py:88: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  torch.tensor(A0_acc.avg), torch.tensor(AT_acc.avg)
total train:   1%|▏         | 1/70 [03:22<3:53:23, 202.95s/it]4.953087329864502 0
lrs:
8.571428571428571e-05
---------------------------------
total train:   3%|▎         | 2/70 [06:48<3:51:46, 204.50s/it]18.590442657470703 4.953087329864502
lrs:
0.00012857142857142855
---------------------------------
total train:   4%|▍         | 3/70 [10:14<3:49:20, 205.38s/it]19.506874084472656 18.590442657470703
lrs:
0.00017142857142857143
---------------------------------
total train:   6%|▌         | 4/70 [13:40<3:45:50, 205.31s/it]20.57604217529297 19.506874084472656
lrs:
0.00021428571428571427
---------------------------------
total train:   7%|▋         | 5/70 [17:03<3:41:47, 204.73s/it]22.277984619140625 20.57604217529297
lrs:
0.0002571428571428571
---------------------------------
total train:   9%|▊         | 6/70 [20:32<3:39:40, 205.94s/it]23.718088150024414 22.277984619140625
lrs:
0.0003
---------------------------------
total train:  10%|█         | 7/70 [23:57<3:36:12, 205.91s/it]25.90006446838379 23.718088150024414
lrs:
0.00034285714285714285
---------------------------------
total train:  11%|█▏        | 8/70 [27:20<3:31:31, 204.71s/it]25.572769165039062 25.90006446838379
lrs:
0.00038571428571428567
---------------------------------
total train:  13%|█▎        | 9/70 [30:41<3:27:12, 203.80s/it]25.223651885986328 25.90006446838379
/home/zhouyufan/Projects/PDPP/utils/training.py:275: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  return torch.tensor(losses.avg), acc1, acc5, torch.tensor(trajectory_success_rate), \
total train:  14%|█▍        | 10/70 [34:11<3:25:33, 205.56s/it]25.812786102294922 25.90006446838379
lrs:
0.0004714285714285714
---------------------------------
total train:  16%|█▌        | 11/70 [37:37<3:22:24, 205.83s/it]26.554658889770508 25.90006446838379
lrs:
0.0005
---------------------------------
total train:  17%|█▋        | 12/70 [41:04<3:19:04, 205.94s/it]29.15121078491211 26.554658889770508
lrs:
0.0005
---------------------------------
total train:  19%|█▊        | 13/70 [44:30<3:15:46, 206.07s/it]31.660484313964844 29.15121078491211
lrs:
0.0005
---------------------------------
total train:  20%|██        | 14/70 [47:53<3:11:25, 205.10s/it]33.493343353271484 31.660484313964844
lrs:
0.0005
---------------------------------
total train:  21%|██▏       | 15/70 [51:17<3:07:47, 204.86s/it]33.79882049560547 33.493343353271484
lrs:
0.0005
---------------------------------
total train:  23%|██▎       | 16/70 [54:39<3:03:36, 204.01s/it]35.19528579711914 33.79882049560547
lrs:
0.0005
---------------------------------
total train:  24%|██▍       | 17/70 [58:01<2:59:43, 203.47s/it]35.93716049194336 35.19528579711914
lrs:
0.0005
---------------------------------
total train:  26%|██▌       | 18/70 [1:01:26<2:56:42, 203.90s/it]36.50447463989258 35.93716049194336
lrs:
0.0005
---------------------------------
total train:  27%|██▋       | 19/70 [1:04:52<2:53:46, 204.43s/it]37.02814865112305 36.50447463989258
total train:  29%|██▊       | 20/70 [1:08:25<2:52:36, 207.14s/it]37.53000259399414 37.02814865112305
lrs:
0.0005
---------------------------------
total train:  30%|███       | 21/70 [1:11:51<2:48:47, 206.67s/it]37.6827392578125 37.53000259399414
lrs:
0.0005
---------------------------------
total train:  31%|███▏      | 22/70 [1:15:11<2:43:40, 204.59s/it]37.551822662353516 37.6827392578125
lrs:
0.0005
---------------------------------
total train:  33%|███▎      | 23/70 [1:18:37<2:40:45, 205.22s/it]37.96639633178711 37.6827392578125
lrs:
0.0005
---------------------------------
total train:  34%|███▍      | 24/70 [1:22:07<2:38:14, 206.41s/it]38.20641326904297 37.96639633178711
lrs:
0.0005
---------------------------------
total train:  36%|███▌      | 25/70 [1:25:32<2:34:32, 206.06s/it]38.25005340576172 38.20641326904297
lrs:
0.0005
---------------------------------
total train:  37%|███▋      | 26/70 [1:29:00<2:31:39, 206.81s/it]38.42461395263672 38.25005340576172
lrs:
0.0005
---------------------------------
total train:  39%|███▊      | 27/70 [1:32:28<2:28:22, 207.04s/it]38.75190734863281 38.42461395263672
lrs:
0.0005
---------------------------------
total train:  40%|████      | 28/70 [1:35:56<2:25:06, 207.30s/it]38.81736755371094 38.75190734863281
lrs:
0.0005
---------------------------------
total train:  41%|████▏     | 29/70 [1:39:23<2:21:34, 207.18s/it]38.99192810058594 38.81736755371094
total train:  43%|████▎     | 30/70 [1:42:57<2:19:32, 209.30s/it]39.2319450378418 38.99192810058594
lrs:
0.00025
---------------------------------
total train:  44%|████▍     | 31/70 [1:46:21<2:14:57, 207.63s/it]39.384681701660156 39.2319450378418
lrs:
0.00025
---------------------------------
total train:  46%|████▌     | 32/70 [1:49:41<2:10:05, 205.42s/it]39.1446647644043 39.384681701660156
lrs:
0.00025
---------------------------------
total train:  47%|████▋     | 33/70 [1:53:07<2:06:47, 205.61s/it]39.515602111816406 39.384681701660156
lrs:
0.00025
---------------------------------
total train:  49%|████▊     | 34/70 [1:56:27<2:02:18, 203.84s/it]39.341041564941406 39.515602111816406
lrs:
0.00025
---------------------------------
total train:  50%|█████     | 35/70 [1:59:48<1:58:24, 202.98s/it]39.31922149658203 39.515602111816406
lrs:
0.00025
---------------------------------
total train:  51%|█████▏    | 36/70 [2:03:10<1:54:49, 202.63s/it]39.45014190673828 39.515602111816406
lrs:
0.00025
---------------------------------
total train:  53%|█████▎    | 37/70 [2:06:30<1:51:06, 202.01s/it]39.25376510620117 39.515602111816406
lrs:
0.00025
---------------------------------
total train:  54%|█████▍    | 38/70 [2:09:58<1:48:38, 203.72s/it]39.842899322509766 39.515602111816406
lrs:
0.00025
---------------------------------
total train:  56%|█████▌    | 39/70 [2:13:18<1:44:45, 202.75s/it]39.559242248535156 39.842899322509766
total train:  57%|█████▋    | 40/70 [2:16:49<1:42:31, 205.05s/it]39.515602111816406 39.842899322509766
lrs:
0.00025
---------------------------------
total train:  59%|█████▊    | 41/70 [2:20:12<1:38:49, 204.47s/it]39.12284469604492 39.842899322509766
lrs:
0.00025
---------------------------------
total train:  60%|██████    | 42/70 [2:23:33<1:35:01, 203.62s/it]39.21012496948242 39.842899322509766
lrs:
0.00025
---------------------------------
total train:  61%|██████▏   | 43/70 [2:26:58<1:31:42, 203.79s/it]39.03556442260742 39.842899322509766
lrs:
0.00025
---------------------------------
total train:  63%|██████▎   | 44/70 [2:30:21<1:28:17, 203.76s/it]39.45014190673828 39.842899322509766
lrs:
0.00025
---------------------------------
total train:  64%|██████▍   | 45/70 [2:33:42<1:24:33, 202.94s/it]39.18830490112305 39.842899322509766
lrs:
0.00025
---------------------------------
total train:  66%|██████▌   | 46/70 [2:37:07<1:21:19, 203.32s/it]39.03556442260742 39.842899322509766
lrs:
0.000125
---------------------------------
total train:  67%|██████▋   | 47/70 [2:40:28<1:17:40, 202.64s/it]39.12284469604492 39.842899322509766
lrs:
0.000125
---------------------------------
total train:  69%|██████▊   | 48/70 [2:43:47<1:13:58, 201.76s/it]39.12284469604492 39.842899322509766
lrs:
0.000125
---------------------------------
total train:  70%|███████   | 49/70 [2:47:11<1:10:51, 202.44s/it]38.81736755371094 39.842899322509766
total train:  71%|███████▏  | 50/70 [2:50:43<1:08:21, 205.08s/it]38.70827102661133 39.842899322509766
lrs:
0.000125
---------------------------------
total train:  73%|███████▎  | 51/70 [2:54:03<1:04:31, 203.75s/it]38.68645095825195 39.842899322509766
lrs:
0.000125
---------------------------------
total train:  74%|███████▍  | 52/70 [2:57:26<1:01:00, 203.34s/it]38.66463088989258 39.842899322509766
lrs:
0.000125
---------------------------------
total train:  76%|███████▌  | 53/70 [3:00:46<57:23, 202.59s/it]  38.5555305480957 39.842899322509766
lrs:
0.000125
---------------------------------
total train:  77%|███████▋  | 54/70 [3:04:06<53:48, 201.78s/it]38.46825408935547 39.842899322509766
lrs:
0.000125
---------------------------------
total train:  79%|███████▊  | 55/70 [3:07:27<50:21, 201.41s/it]38.315513610839844 39.842899322509766
lrs:
0.000125
---------------------------------
total train:  80%|████████  | 56/70 [3:10:47<46:55, 201.11s/it]38.25005340576172 39.842899322509766
lrs:
0.000125
---------------------------------
total train:  81%|████████▏ | 57/70 [3:14:11<43:45, 201.98s/it]38.271873474121094 39.842899322509766
lrs:
0.000125
---------------------------------
