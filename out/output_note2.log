nohup: ignoring input
/home/zhouyufan/anaconda3/envs/ZYF/lib/python3.10/site-packages/torch/nn/modules/transformer.py:306: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
Namespace(checkpoint_root='/home/zhouyufan/Projects/PDPP/checkpoint', checkpoint_max_root='/home/zhouyufan/Projects/PDPP/save_max', log_root='/home/zhouyufan/Projects/PDPP/log_mlp/log_mlp', checkpoint_dir='whl', optimizer='adam', num_thread_reader=8, batch_size=256, batch_size_val=256, momemtum=0.9, save_freq=1, crop_only=1, centercrop=0, random_flip=1, verbose=1, fps=1, cudnn_benchmark=1, dataset='coin', action_dim=778, observation_dim=1536, class_dim=180, root='/home/zhouyufan/Projects/PDPP/dataset/coin', json_path_train='/home/zhouyufan/Projects/PDPP/dataset/coin/coin_train_70.json', json_path_val='/home/zhouyufan/Projects/PDPP/dataset/coin/coin_test_30.json', json_path_val2='/home/zhouyufan/Projects/PDPP/dataset/coin/output3.json', n_train_steps=200, start_epoch=0, resume=False, evaluate=True, pretrained=False, pin_memory=True, world_size=1, rank=0, dist_file='dist-file', dist_backend='nccl', multiprocessing_distributed=False, name='note2', loss_type='Weighted_Gradient_MSE', ckpt_path='', dist_port=21712, log_freq=500, gpu=4, seed=217, weight=6, n_diffusion_steps=200, clip_denoised=True, ddim_discr_method='uniform', lr=1e-05, ema_decay=0.995, gradient_accumulate_every=1, step_start_ema=400, update_ema_every=10, imageEncoder=0, transformer_num=5, base_model='base', num_heads=4, num_layers=2, dim_feedforward=2048, dropout=0.9, horizon=3, epochs=800)
Namespace(checkpoint_root='/home/zhouyufan/Projects/PDPP/checkpoint', checkpoint_max_root='/home/zhouyufan/Projects/PDPP/save_max', log_root='/home/zhouyufan/Projects/PDPP/log_mlp/log_mlp', checkpoint_dir='whl', optimizer='adam', num_thread_reader=8, batch_size=256, batch_size_val=256, momemtum=0.9, save_freq=1, crop_only=1, centercrop=0, random_flip=1, verbose=1, fps=1, cudnn_benchmark=1, dataset='coin', action_dim=778, observation_dim=1536, class_dim=180, root='/home/zhouyufan/Projects/PDPP/dataset/coin', json_path_train='/home/zhouyufan/Projects/PDPP/dataset/coin/coin_train_70.json', json_path_val='/home/zhouyufan/Projects/PDPP/dataset/coin/coin_test_30.json', json_path_val2='/home/zhouyufan/Projects/PDPP/dataset/coin/output3.json', n_train_steps=200, start_epoch=0, resume=False, evaluate=True, pretrained=False, pin_memory=True, world_size=1, rank=0, dist_file='dist-file', dist_backend='nccl', multiprocessing_distributed=False, name='note2', loss_type='Weighted_Gradient_MSE', ckpt_path='', dist_port=21712, log_freq=500, gpu=4, seed=217, weight=6, n_diffusion_steps=200, clip_denoised=True, ddim_discr_method='uniform', lr=1e-05, ema_decay=0.995, gradient_accumulate_every=1, step_start_ema=400, update_ema_every=10, imageEncoder=0, transformer_num=5, base_model='base', num_heads=4, num_layers=2, dim_feedforward=2048, dropout=0.9, horizon=3, epochs=800, distributed=False)
coin
Loaded /home/zhouyufan/Projects/PDPP/dataset/coin/coin_train_70.json
coin
Loaded /home/zhouyufan/Projects/PDPP/dataset/coin/coin_test_30.json
logging outputs to  /home/zhouyufan/Projects/PDPP/log_mlp/log_mlp_note2_20240824102552_coin
total_mlp:   0%|          | 0/800 [00:00<?, ?it/s]total_mlp:   0%|          | 1/800 [00:07<1:45:31,  7.92s/it]lrs:
7.5e-07
---------------------------------
/home/zhouyufan/Projects/PDPP/train_mlp.py:502: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  return torch.tensor(losses.avg), torch.tensor(acc)
total_mlp:   0%|          | 2/800 [00:16<1:54:21,  8.60s/it]total_mlp:   0%|          | 3/800 [00:24<1:47:42,  8.11s/it]lrs:
2.25e-06
---------------------------------
total_mlp:   0%|          | 4/800 [00:34<1:57:47,  8.88s/it]total_mlp:   1%|          | 5/800 [00:41<1:45:57,  8.00s/it]lrs:
3.75e-06
---------------------------------
total_mlp:   1%|          | 6/800 [00:48<1:45:07,  7.94s/it]total_mlp:   1%|          | 7/800 [00:54<1:34:39,  7.16s/it]lrs:
5.25e-06
---------------------------------
total_mlp:   1%|          | 8/800 [01:02<1:38:45,  7.48s/it]total_mlp:   1%|          | 9/800 [01:07<1:29:18,  6.77s/it]lrs:
6.75e-06
---------------------------------
total_mlp:   1%|▏         | 10/800 [01:15<1:34:17,  7.16s/it]total_mlp:   1%|▏         | 11/800 [01:21<1:26:58,  6.61s/it]lrs:
8.249999999999999e-06
---------------------------------
total_mlp:   2%|▏         | 12/800 [01:28<1:31:34,  6.97s/it]total_mlp:   2%|▏         | 13/800 [01:34<1:25:03,  6.48s/it]lrs:
9.75e-06
---------------------------------
total_mlp:   2%|▏         | 14/800 [01:42<1:29:48,  6.86s/it]total_mlp:   2%|▏         | 15/800 [01:47<1:23:29,  6.38s/it]lrs:
1.1249999999999999e-05
---------------------------------
total_mlp:   2%|▏         | 16/800 [01:55<1:28:38,  6.78s/it]total_mlp:   2%|▏         | 17/800 [02:00<1:22:55,  6.35s/it]lrs:
1.2750000000000002e-05
---------------------------------
total_mlp:   2%|▏         | 18/800 [02:08<1:28:05,  6.76s/it]total_mlp:   2%|▏         | 19/800 [02:13<1:21:49,  6.29s/it]lrs:
1.4249999999999999e-05
---------------------------------
total_mlp:   2%|▎         | 20/800 [02:21<1:27:23,  6.72s/it]total_mlp:   3%|▎         | 21/800 [02:26<1:22:25,  6.35s/it]lrs:
1.575e-05
---------------------------------
total_mlp:   3%|▎         | 22/800 [02:34<1:28:40,  6.84s/it]total_mlp:   3%|▎         | 23/800 [02:39<1:21:53,  6.32s/it]lrs:
1.725e-05
---------------------------------
total_mlp:   3%|▎         | 24/800 [02:47<1:26:52,  6.72s/it]total_mlp:   3%|▎         | 25/800 [02:55<1:33:37,  7.25s/it]lrs:
1.8750000000000002e-05
---------------------------------
total_mlp:   3%|▎         | 26/800 [03:07<1:49:40,  8.50s/it]total_mlp:   3%|▎         | 27/800 [03:16<1:52:13,  8.71s/it]lrs:
2.025e-05
---------------------------------
total_mlp:   4%|▎         | 28/800 [03:28<2:04:59,  9.71s/it]total_mlp:   4%|▎         | 29/800 [03:37<2:03:13,  9.59s/it]lrs:
2.175e-05
---------------------------------
total_mlp:   4%|▍         | 30/800 [03:47<2:04:24,  9.69s/it]total_mlp:   4%|▍         | 31/800 [03:56<2:00:56,  9.44s/it]lrs:
2.325e-05
---------------------------------
total_mlp:   4%|▍         | 32/800 [04:07<2:07:57, 10.00s/it]total_mlp:   4%|▍         | 33/800 [04:15<1:59:07,  9.32s/it]lrs:
2.4750000000000002e-05
---------------------------------
total_mlp:   4%|▍         | 34/800 [04:23<1:54:10,  8.94s/it]total_mlp:   4%|▍         | 35/800 [04:30<1:44:31,  8.20s/it]lrs:
2.625e-05
---------------------------------
total_mlp:   4%|▍         | 36/800 [04:42<1:59:12,  9.36s/it]total_mlp:   5%|▍         | 37/800 [04:51<1:58:58,  9.36s/it]lrs:
2.7749999999999997e-05
---------------------------------
total_mlp:   5%|▍         | 38/800 [04:59<1:55:10,  9.07s/it]total_mlp:   5%|▍         | 39/800 [05:09<1:55:45,  9.13s/it]lrs:
2.925e-05
---------------------------------
total_mlp:   5%|▌         | 40/800 [05:19<2:01:21,  9.58s/it]total_mlp:   5%|▌         | 41/800 [05:27<1:53:07,  8.94s/it]lrs:
3.075e-05
---------------------------------
total_mlp:   5%|▌         | 42/800 [05:38<2:00:03,  9.50s/it]total_mlp:   5%|▌         | 43/800 [05:47<2:00:33,  9.56s/it]lrs:
3.2250000000000005e-05
---------------------------------
total_mlp:   6%|▌         | 44/800 [05:58<2:06:33, 10.04s/it]total_mlp:   6%|▌         | 45/800 [06:08<2:04:30,  9.89s/it]lrs:
3.375e-05
---------------------------------
total_mlp:   6%|▌         | 46/800 [06:18<2:05:04,  9.95s/it]total_mlp:   6%|▌         | 47/800 [06:32<2:19:31, 11.12s/it]lrs:
3.525e-05
---------------------------------
total_mlp:   6%|▌         | 48/800 [06:48<2:38:44, 12.67s/it]total_mlp:   6%|▌         | 49/800 [07:01<2:39:13, 12.72s/it]lrs:
3.675e-05
---------------------------------
total_mlp:   6%|▋         | 50/800 [07:16<2:47:22, 13.39s/it]total_mlp:   6%|▋         | 51/800 [07:29<2:45:20, 13.24s/it]lrs:
3.825e-05
---------------------------------
total_mlp:   6%|▋         | 52/800 [07:44<2:53:07, 13.89s/it]total_mlp:   7%|▋         | 53/800 [07:58<2:52:00, 13.82s/it]lrs:
3.975e-05
---------------------------------
total_mlp:   7%|▋         | 54/800 [08:14<2:59:00, 14.40s/it]total_mlp:   7%|▋         | 55/800 [08:29<3:01:04, 14.58s/it]lrs:
4.125e-05
---------------------------------
total_mlp:   7%|▋         | 56/800 [08:49<3:21:25, 16.24s/it]total_mlp:   7%|▋         | 57/800 [09:05<3:22:35, 16.36s/it]lrs:
4.275e-05
---------------------------------
total_mlp:   7%|▋         | 58/800 [09:25<3:32:33, 17.19s/it]total_mlp:   7%|▋         | 59/800 [09:41<3:29:35, 16.97s/it]lrs:
4.4250000000000005e-05
---------------------------------
total_mlp:   8%|▊         | 60/800 [09:59<3:33:57, 17.35s/it]total_mlp:   8%|▊         | 61/800 [10:16<3:32:25, 17.25s/it]lrs:
4.575e-05
---------------------------------
total_mlp:   8%|▊         | 62/800 [10:34<3:35:07, 17.49s/it]total_mlp:   8%|▊         | 63/800 [10:47<3:15:26, 15.91s/it]lrs:
4.7249999999999997e-05
---------------------------------
total_mlp:   8%|▊         | 64/800 [11:01<3:10:07, 15.50s/it]total_mlp:   8%|▊         | 65/800 [11:15<3:04:41, 15.08s/it]lrs:
4.875e-05
---------------------------------
total_mlp:   8%|▊         | 66/800 [11:30<3:03:12, 14.98s/it]total_mlp:   8%|▊         | 67/800 [11:43<2:55:54, 14.40s/it]lrs:
5.0249999999999995e-05
---------------------------------
total_mlp:   8%|▊         | 68/800 [11:58<2:57:45, 14.57s/it]total_mlp:   9%|▊         | 69/800 [12:11<2:52:45, 14.18s/it]lrs:
5.175e-05
---------------------------------
total_mlp:   9%|▉         | 70/800 [12:26<2:55:07, 14.39s/it]total_mlp:   9%|▉         | 71/800 [12:40<2:52:04, 14.16s/it]lrs:
5.325e-05
---------------------------------
total_mlp:   9%|▉         | 72/800 [12:55<2:57:10, 14.60s/it]total_mlp:   9%|▉         | 73/800 [13:13<3:07:18, 15.46s/it]lrs:
5.475e-05
---------------------------------
total_mlp:   9%|▉         | 74/800 [13:31<3:17:12, 16.30s/it]total_mlp:   9%|▉         | 75/800 [13:47<3:16:16, 16.24s/it]lrs:
5.6250000000000005e-05
---------------------------------
total_mlp:  10%|▉         | 76/800 [14:05<3:23:13, 16.84s/it]total_mlp:  10%|▉         | 77/800 [14:23<3:24:51, 17.00s/it]lrs:
5.775e-05
---------------------------------
total_mlp:  10%|▉         | 78/800 [14:40<3:27:00, 17.20s/it]total_mlp:  10%|▉         | 79/800 [14:58<3:27:17, 17.25s/it]lrs:
5.9250000000000004e-05
---------------------------------
total_mlp:  10%|█         | 80/800 [15:11<3:13:49, 16.15s/it]total_mlp:  10%|█         | 81/800 [15:24<3:02:00, 15.19s/it]lrs:
6.074999999999999e-05
---------------------------------
total_mlp:  10%|█         | 82/800 [15:39<3:00:09, 15.05s/it]total_mlp:  10%|█         | 83/800 [15:53<2:55:42, 14.70s/it]lrs:
6.225e-05
---------------------------------
total_mlp:  10%|█         | 84/800 [16:06<2:48:52, 14.15s/it]total_mlp:  11%|█         | 85/800 [16:20<2:48:07, 14.11s/it]lrs:
6.375e-05
---------------------------------
total_mlp:  11%|█         | 86/800 [16:35<2:49:55, 14.28s/it]total_mlp:  11%|█         | 87/800 [16:47<2:44:49, 13.87s/it]lrs:
6.525e-05
---------------------------------
total_mlp:  11%|█         | 88/800 [17:03<2:49:03, 14.25s/it]total_mlp:  11%|█         | 89/800 [17:17<2:47:55, 14.17s/it]lrs:
6.675e-05
---------------------------------
total_mlp:  11%|█▏        | 90/800 [17:36<3:04:48, 15.62s/it]total_mlp:  11%|█▏        | 91/800 [17:53<3:10:43, 16.14s/it]lrs:
6.825e-05
---------------------------------
total_mlp:  12%|█▏        | 92/800 [18:12<3:20:17, 16.97s/it]total_mlp:  12%|█▏        | 93/800 [18:28<3:18:31, 16.85s/it]lrs:
6.975e-05
---------------------------------
total_mlp:  12%|█▏        | 94/800 [18:48<3:27:27, 17.63s/it]total_mlp:  12%|█▏        | 95/800 [19:05<3:25:35, 17.50s/it]lrs:
7.125000000000001e-05
---------------------------------
total_mlp:  12%|█▏        | 96/800 [19:24<3:29:27, 17.85s/it]total_mlp:  12%|█▏        | 97/800 [19:38<3:15:49, 16.71s/it]lrs:
7.274999999999999e-05
---------------------------------
total_mlp:  12%|█▏        | 98/800 [19:57<3:24:54, 17.51s/it]total_mlp:  12%|█▏        | 99/800 [20:14<3:22:23, 17.32s/it]lrs:
7.425e-05
---------------------------------
total_mlp:  12%|█▎        | 100/800 [20:32<3:25:45, 17.64s/it]total_mlp:  13%|█▎        | 101/800 [20:49<3:20:24, 17.20s/it]lrs:
7.575e-05
---------------------------------
total_mlp:  13%|█▎        | 102/800 [21:08<3:26:09, 17.72s/it]total_mlp:  13%|█▎        | 103/800 [21:25<3:24:21, 17.59s/it]lrs:
7.725e-05
---------------------------------
total_mlp:  13%|█▎        | 104/800 [21:44<3:29:39, 18.07s/it]total_mlp:  13%|█▎        | 105/800 [21:58<3:14:33, 16.80s/it]lrs:
7.875e-05
---------------------------------
total_mlp:  13%|█▎        | 106/800 [22:14<3:12:40, 16.66s/it]total_mlp:  13%|█▎        | 107/800 [22:28<3:02:04, 15.76s/it]lrs:
8.025e-05
---------------------------------
total_mlp:  14%|█▎        | 108/800 [22:44<3:02:42, 15.84s/it]total_mlp:  14%|█▎        | 109/800 [22:57<2:53:26, 15.06s/it]lrs:
8.175000000000001e-05
---------------------------------
total_mlp:  14%|█▍        | 110/800 [23:12<2:53:53, 15.12s/it]total_mlp:  14%|█▍        | 111/800 [23:26<2:48:40, 14.69s/it]lrs:
8.324999999999999e-05
---------------------------------
total_mlp:  14%|█▍        | 112/800 [23:42<2:53:06, 15.10s/it]total_mlp:  14%|█▍        | 113/800 [23:54<2:41:15, 14.08s/it]lrs:
8.475e-05
---------------------------------
total_mlp:  14%|█▍        | 114/800 [24:11<2:51:04, 14.96s/it]total_mlp:  14%|█▍        | 115/800 [24:28<2:58:22, 15.62s/it]lrs:
8.625e-05
---------------------------------
total_mlp:  14%|█▍        | 116/800 [24:47<3:10:10, 16.68s/it]total_mlp:  15%|█▍        | 117/800 [25:04<3:10:05, 16.70s/it]lrs:
8.775e-05
---------------------------------
total_mlp:  15%|█▍        | 118/800 [25:23<3:19:12, 17.53s/it]total_mlp:  15%|█▍        | 119/800 [25:40<3:16:14, 17.29s/it]lrs:
8.925e-05
---------------------------------
total_mlp:  15%|█▌        | 120/800 [26:00<3:24:35, 18.05s/it]total_mlp:  15%|█▌        | 121/800 [26:16<3:19:19, 17.61s/it]lrs:
9.075e-05
---------------------------------
total_mlp:  15%|█▌        | 122/800 [26:32<3:12:26, 17.03s/it]total_mlp:  15%|█▌        | 123/800 [26:46<3:02:23, 16.16s/it]lrs:
9.225e-05
---------------------------------
total_mlp:  16%|█▌        | 124/800 [27:02<3:00:52, 16.05s/it]total_mlp:  16%|█▌        | 125/800 [27:16<2:51:48, 15.27s/it]lrs:
9.375e-05
---------------------------------
total_mlp:  16%|█▌        | 126/800 [27:32<2:54:13, 15.51s/it]total_mlp:  16%|█▌        | 127/800 [27:45<2:45:32, 14.76s/it]lrs:
9.525e-05
---------------------------------
total_mlp:  16%|█▌        | 128/800 [28:01<2:49:46, 15.16s/it]