nohup: ignoring input
Namespace(checkpoint_root='/home/zhouyufan/Projects/PDPP/checkpoint', checkpoint_max_root='/home/zhouyufan/Projects/PDPP/save_max', log_root='/home/zhouyufan/Projects/PDPP/log/log_mlp', checkpoint_dir='whl', optimizer='adam', num_thread_reader=8, batch_size=256, batch_size_val=256, pretrain_cnn_path='', momemtum=0.9, save_freq=1, crop_only=1, centercrop=0, random_flip=1, verbose=1, fps=1, cudnn_benchmark=1, dataset='crosstask_base', action_dim=105, observation_dim=9600, class_dim=18, root='/home/zhouyufan/Projects/PDPP/dataset/crosstask', json_path_train='/home/zhouyufan/Projects/PDPP/dataset/crosstask/crosstask_release/base/train_list.json', json_path_val='/home/zhouyufan/Projects/PDPP/dataset/crosstask/crosstask_release/base/test_list.json', json_path_val2='/home/zhouyufan/Projects/PDPP/dataset/crosstask/crosstask_release/base/output.json', n_train_steps=200, start_epoch=0, resume=False, evaluate=True, pretrained=False, pin_memory=True, world_size=1, rank=0, dist_file='dist-file', dist_backend='nccl', gpu=6, multiprocessing_distributed=False, name='note', loss_type='Weighted_Gradient_MSE', ckpt_path='', dist_port=21712, horizon=3, epochs=70, log_freq=500, seed=217, weight=6, n_diffusion_steps=200, clip_denoised=True, ddim_discr_method='uniform', lr=0.0005, ema_decay=0.995, gradient_accumulate_every=1, step_start_ema=400, update_ema_every=10, imageEncoder=0, transformer_num=5, base_model='base')
crosstask_base
feature_base
is_valFalse
Loaded /home/zhouyufan/Projects/PDPP/dataset/crosstask/crosstask_release/base/train_list.json
crosstask_base
feature_base
handling raw json------------------
logging outputs to  /home/zhouyufan/Projects/PDPP/log/log_mlp_note_20240729160505_crosstask_base
total_mlp:   0%|          | 0/70 [00:00<?, ?it/s]total_mlp:   0%|          | 0/70 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/home/zhouyufan/Projects/PDPP/train_mlp.py", line 514, in <module>
    main()
  File "/home/zhouyufan/Projects/PDPP/train_mlp.py", line 190, in main
    main_worker(args.gpu, ngpus_per_node, args)
  File "/home/zhouyufan/Projects/PDPP/train_mlp.py", line 376, in main_worker
    losses = train(train_loader, args.n_train_steps, model,
  File "/home/zhouyufan/Projects/PDPP/train_mlp.py", line 443, in train
    batch = next(train_loader_)
  File "/home/zhouyufan/Projects/PDPP/train_mlp.py", line 29, in cycle
    for data in dl:
  File "/home/zhouyufan/anaconda3/envs/ZYF/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 631, in __next__
    data = self._next_data()
  File "/home/zhouyufan/anaconda3/envs/ZYF/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1346, in _next_data
    return self._process_data(data)
  File "/home/zhouyufan/anaconda3/envs/ZYF/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1372, in _process_data
    data.reraise()
  File "/home/zhouyufan/anaconda3/envs/ZYF/lib/python3.10/site-packages/torch/_utils.py", line 705, in reraise
    raise exception
IndexError: Caught IndexError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/zhouyufan/anaconda3/envs/ZYF/lib/python3.10/site-packages/torch/utils/data/_utils/worker.py", line 308, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
  File "/home/zhouyufan/anaconda3/envs/ZYF/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/zhouyufan/anaconda3/envs/ZYF/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 51, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/zhouyufan/Projects/PDPP/dataloader/data_load_mlp.py", line 500, in __getitem__
    frames, labels, task = self.sample_single(index)
  File "/home/zhouyufan/Projects/PDPP/dataloader/data_load_mlp.py", line 482, in sample_single
    self.images = images_['frames_features']
IndexError: only integers, slices (`:`), ellipsis (`...`), numpy.newaxis (`None`) and integer or boolean arrays are valid indices

